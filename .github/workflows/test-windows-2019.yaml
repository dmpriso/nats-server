name: Windows Server 2019 - Tests

on: [push]

env:
  GO_VERSION: "^1.19.10"

jobs:
  js-no-cluster:
    name: JetStream - No Cluster
    runs-on: windows-2019
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Install Go
        uses: actions/setup-go@v4
        with:
          go-version: ${{ env.GO_VERSION }}

      - name: Install Deps
        run: go mod download

      - name: Run Tests
        run: |-
          go test -race -v \
            -run TestJetStream \
            -tags "skip_js_cluster_tests,skip_js_cluster_tests_2,skip_js_cluster_tests_3,skip_js_super_cluster_tests" \
            -count 1 -vet off -timeout 30m -failfast \
            ./server/...
